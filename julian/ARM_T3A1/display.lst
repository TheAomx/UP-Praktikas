   1              		.file	"display.c"
   9              	.Ltext0:
  10              		.align	2
  11              		.global	delay1us
  13              	delay1us:
  14              	.LFB2:
  15              		.file 1 "display.c"
   1:display.c     **** //********************************************************************
   2:display.c     **** // display.c									Version 02.04.2012 hpw
   3:display.c     **** //********************************************************************
   4:display.c     **** #define 	FULL_PRINTF	0
   5:display.c     **** 
   6:display.c     **** #include	"include/AT91SAM7S64.h"
   7:display.c     **** #include	"include/display.h"
   8:display.c     **** #include	"include/stdarg.h"
   9:display.c     **** #if FULL_PRINTF == 1
  10:display.c     **** 	#include "include/stdio.h"						// Definiton I/O
  11:display.c     **** #endif
  12:display.c     **** 
  13:display.c     **** //**************************************************************
  14:display.c     **** // delay1us(uiK) verzögert um uiK * 1us bei MCK=24Hz
  15:display.c     **** // uiK <= 1.073.741.823 us = 17,8957 sec
  16:display.c     **** //**************************************************************
  17:display.c     **** __attribute__ ((naked)) void delay1us(unsigned int uiK){
  16              	 Naked Function: prologue and epilogue provided by programmer.
  17              		@ args = 0, pretend = 0, frame = 4
  18              		@ frame_needed = 1, uses_anonymous_args = 0
  19              		str	r0, [fp, #0]
  20 0000 00008BE5 		.loc 1 19 0
  18:display.c     **** 
  19:display.c     **** 	asm("			lsl	r3, r0, #2		\n\t"		// Multiplikation *4
  21              	"display.c" 1
  22              					lsl	r3, r0, #2		
  23 0004 0031A0E1 		Label:		cmp	r3, #0			
  24 0008 000053E3 					beq	Ende			
  25 000c 0100000A 					sub	r3, r3, #1		
  26 0010 013043E2 					b	Label			
  27 0014 FBFFFFEA 		Ende:		mov	pc, lr			
  28 0018 0EF0A0E1 		
  29              	@ 0 "" 2
  30              		.loc 1 25 0
  20:display.c     **** 		"Label:		cmp	r3, #0			\n\t"		// 1
  21:display.c     **** 		"			beq	Ende			\n\t"		// 2
  22:display.c     **** 		"			sub	r3, r3, #1		\n\t"		// 1
  23:display.c     **** 		"			b	Label			\n\t"		// 2
  24:display.c     **** 		"Ende:		mov	pc, lr			\n\t");
  25:display.c     **** }
  31              	ize	delay1us, .-delay1us
  32              		.align	2
  33              		.global	lcd_write
  35              	lcd_write:
  36              	.LFB3:
  37              		.loc 1 33 0
  38              		@ args = 0, pretend = 0, frame = 8
  26:display.c     **** 
  27:display.c     **** //**************************************************************
  28:display.c     **** // UP-Name:			display_write(data,RS)
  29:display.c     **** // Beschreibung:	Schreibt auf das LCD mit
  30:display.c     **** // 					RS=0	Kommando
  31:display.c     **** // 					RS=1	Zeichenausgabe
  32:display.c     **** //**************************************************************
  33:display.c     **** void lcd_write(unsigned char data, unsigned char rs){
  39              	_needed = 1, uses_anonymous_args = 0
  40              		mov	ip, sp
  41              	.LCFI0:
  42 001c 0DC0A0E1 		stmfd	sp!, {fp, ip, lr, pc}
  43              	.LCFI1:
  44 0020 00D82DE9 		sub	fp, ip, #4
  45              	.LCFI2:
  46 0024 04B04CE2 		sub	sp, sp, #8
  47              	.LCFI3:
  48 0028 08D04DE2 		mov	r3, r0
  49              		mov	r2, r1
  50 002c 0030A0E1 		strb	r3, [fp, #-16]
  51 0030 0120A0E1 		mov	r3, r2
  52 0034 10304BE5 		strb	r3, [fp, #-20]
  53 0038 0230A0E1 		.loc 1 34 0
  54 003c 14304BE5 		mov	r3, #-1610612736
  34:display.c     **** 	LCD_PORT->PIO_CODR = LCD_RW;					// Schreibzugriff
  55              	 #19
  56 0040 0A32A0E3 		mov	r2, #134217728
  57 0044 C339A0E1 		str	r2, [r3, #52]
  58 0048 0223A0E3 		.loc 1 35 0
  59 004c 342083E5 		ldrb	r3, [fp, #-20]	@ zero_extendqisi2
  35:display.c     **** 	if(rs)	LCD_PORT->PIO_SODR = LCD_RS;			// Register-Select
  60              	r3, #0
  61 0050 14305BE5 		beq	.L4
  62 0054 000053E3 		mov	r3, #-1610612736
  63 0058 0400000A 		mov	r3, r3, asr #19
  64 005c 0A32A0E3 		mov	r2, #536870912
  65 0060 C339A0E1 		str	r2, [r3, #48]
  66 0064 0222A0E3 		b	.L5
  67 0068 302083E5 	.L4:
  68 006c 030000EA 		.loc 1 36 0
  69              		mov	r3, #-1610612736
  36:display.c     **** 	else	LCD_PORT->PIO_CODR = LCD_RS;
  70              	3, asr #19
  71 0070 0A32A0E3 		mov	r2, #536870912
  72 0074 C339A0E1 		str	r2, [r3, #52]
  73 0078 0222A0E3 	.L5:
  74 007c 342083E5 		.loc 1 37 0
  75              		mov	r2, #-1610612736
  37:display.c     **** 	LCD_PORT->PIO_CODR = LCD_DBUS;					// Datenleitungen löschen
  76              	2, r2, asr #19
  77 0080 0A22A0E3 		mov	r3, #117440512
  78 0084 C229A0E1 		add	r3, r3, #7936
  79 0088 0734A0E3 		str	r3, [r2, #52]
  80 008c 1F3C83E2 		.loc 1 38 0
  81 0090 343082E5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  38:display.c     **** 	if(data & 0x01)	LCD_PORT->PIO_SODR = LCD_D0;	// Datenbits setzen, wenn notwendig
  82              	3, r3, #1
  83 0094 10305BE5 		and	r3, r3, #255
  84 0098 013003E2 		cmp	r3, #0
  85 009c FF3003E2 		beq	.L6
  86 00a0 000053E3 		mov	r3, #-1610612736
  87 00a4 0300000A 		mov	r3, r3, asr #19
  88 00a8 0A32A0E3 		mov	r2, #256
  89 00ac C339A0E1 		str	r2, [r3, #48]
  90 00b0 012CA0E3 	.L6:
  91 00b4 302083E5 		.loc 1 39 0
  92              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  39:display.c     **** 	if(data & 0x02)	LCD_PORT->PIO_SODR = LCD_D1;
  93              	, #2
  94 00b8 10305BE5 		cmp	r3, #0
  95 00bc 023003E2 		beq	.L7
  96 00c0 000053E3 		mov	r3, #-1610612736
  97 00c4 0300000A 		mov	r3, r3, asr #19
  98 00c8 0A32A0E3 		mov	r2, #512
  99 00cc C339A0E1 		str	r2, [r3, #48]
 100 00d0 022CA0E3 	.L7:
 101 00d4 302083E5 		.loc 1 40 0
 102              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  40:display.c     **** 	if(data & 0x04)	LCD_PORT->PIO_SODR = LCD_D2;
 103              	3, #4
 104 00d8 10305BE5 		cmp	r3, #0
 105 00dc 043003E2 		beq	.L8
 106 00e0 000053E3 		mov	r3, #-1610612736
 107 00e4 0300000A 		mov	r3, r3, asr #19
 108 00e8 0A32A0E3 		mov	r2, #1024
 109 00ec C339A0E1 		str	r2, [r3, #48]
 110 00f0 012BA0E3 	.L8:
 111 00f4 302083E5 		.loc 1 41 0
 112              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  41:display.c     **** 	if(data & 0x08)	LCD_PORT->PIO_SODR = LCD_D3;
 113              	3, #8
 114 00f8 10305BE5 		cmp	r3, #0
 115 00fc 083003E2 		beq	.L9
 116 0100 000053E3 		mov	r3, #-1610612736
 117 0104 0300000A 		mov	r3, r3, asr #19
 118 0108 0A32A0E3 		mov	r2, #2048
 119 010c C339A0E1 		str	r2, [r3, #48]
 120 0110 022BA0E3 	.L9:
 121 0114 302083E5 		.loc 1 42 0
 122              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  42:display.c     **** 	if(data & 0x10)	LCD_PORT->PIO_SODR = LCD_D4;
 123              	3, #16
 124 0118 10305BE5 		cmp	r3, #0
 125 011c 103003E2 		beq	.L10
 126 0120 000053E3 		mov	r3, #-1610612736
 127 0124 0300000A 		mov	r3, r3, asr #19
 128 0128 0A32A0E3 		mov	r2, #4096
 129 012c C339A0E1 		str	r2, [r3, #48]
 130 0130 012AA0E3 	.L10:
 131 0134 302083E5 		.loc 1 43 0
 132              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  43:display.c     **** 	if(data & 0x20)	LCD_PORT->PIO_SODR = LCD_D5;
 133              	3, #32
 134 0138 10305BE5 		cmp	r3, #0
 135 013c 203003E2 		beq	.L11
 136 0140 000053E3 		mov	r3, #-1610612736
 137 0144 0300000A 		mov	r3, r3, asr #19
 138 0148 0A32A0E3 		mov	r2, #67108864
 139 014c C339A0E1 		str	r2, [r3, #48]
 140 0150 0123A0E3 	.L11:
 141 0154 302083E5 		.loc 1 44 0
 142              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  44:display.c     **** 	if(data & 0x40)	LCD_PORT->PIO_SODR = LCD_D6;
 143              	3, #64
 144 0158 10305BE5 		cmp	r3, #0
 145 015c 403003E2 		beq	.L12
 146 0160 000053E3 		mov	r3, #-1610612736
 147 0164 0300000A 		mov	r3, r3, asr #19
 148 0168 0A32A0E3 		mov	r2, #33554432
 149 016c C339A0E1 		str	r2, [r3, #48]
 150 0170 0224A0E3 	.L12:
 151 0174 302083E5 		.loc 1 45 0
 152              		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  45:display.c     **** 	if(data & 0x80)	LCD_PORT->PIO_SODR = LCD_D7;
 153              	3, asl #24
 154 0178 10305BE5 		mov	r3, r3, asr #24
 155 017c 033CA0E1 		cmp	r3, #0
 156 0180 433CA0E1 		bge	.L13
 157 0184 000053E3 		mov	r3, #-1610612736
 158 0188 030000AA 		mov	r3, r3, asr #19
 159 018c 0A32A0E3 		mov	r2, #16777216
 160 0190 C339A0E1 		str	r2, [r3, #48]
 161 0194 0124A0E3 	.L13:
 162 0198 302083E5 		.loc 1 46 0
 163              		mov	r0, #1
  46:display.c     **** 	delay1us(1);									// kurz warten
 164              	s
 165 019c 0100A0E3 		.loc 1 47 0
 166 01a0 FEFFFFEB 		mov	r3, #-1610612736
  47:display.c     **** 	LCD_PORT->PIO_SODR = LCD_E;						// Enable setzen
 167              	v	r3, r3, asr #19
 168 01a4 0A32A0E3 		mov	r2, #128
 169 01a8 C339A0E1 		str	r2, [r3, #48]
 170 01ac 8020A0E3 		.loc 1 48 0
 171 01b0 302083E5 		mov	r0, #50
  48:display.c     **** 	delay1us(50);									// 50 us warten
 172              	elay1us
 173 01b4 3200A0E3 		.loc 1 49 0
 174 01b8 FEFFFFEB 		mov	r3, #-1610612736
  49:display.c     **** 	LCD_PORT->PIO_CODR = LCD_E;						// Enable zurücksetzen
 175              	v	r3, r3, asr #19
 176 01bc 0A32A0E3 		mov	r2, #128
 177 01c0 C339A0E1 		str	r2, [r3, #52]
 178 01c4 8020A0E3 		.loc 1 50 0
 179 01c8 342083E5 		sub	sp, fp, #12
  50:display.c     **** }
 180              	d	sp, {fp, sp, pc}
 181 01cc 0CD04BE2 	.LFE3:
 183              		.align	2
 184              		.global	display_init
 186              	display_init:
 187              	.LFB4:
 188              		.loc 1 56 0
 189              		@ args = 0, pretend = 0, frame = 0
  51:display.c     **** 
  52:display.c     **** //**************************************************************
  53:display.c     **** // UP_Name:			display_init()
  54:display.c     **** // Beschreibung:	Initialisiert das Display im 8-Bit-Modus
  55:display.c     **** //**************************************************************
  56:display.c     **** void display_init(void){
 190              	eeded = 1, uses_anonymous_args = 0
 191              		mov	ip, sp
 192              	.LCFI4:
 193 01d4 0DC0A0E1 		stmfd	sp!, {fp, ip, lr, pc}
 194              	.LCFI5:
 195 01d8 00D82DE9 		sub	fp, ip, #4
 196              	.LCFI6:
 197 01dc 04B04CE2 		.loc 1 57 0
 198              		mov	r2, #-1610612736
  57:display.c     **** 	LCD_PORT->PIO_PPUDR = LCD_BUS;					// Pullups aus
 199              	r2, asr #19
 200 01e0 0A22A0E3 		mov	r3, #788529152
 201 01e4 C229A0E1 		add	r3, r3, #8064
 202 01e8 2F34A0E3 		str	r3, [r2, #96]
 203 01ec 7E3D83E2 		.loc 1 58 0
 204 01f0 603082E5 		mov	r2, #-1610612736
  58:display.c     **** 	LCD_PORT->PIO_OER = LCD_BUS;					// Port-Pins als Ausgang
 205              	2, r2, asr #19
 206 01f4 0A22A0E3 		mov	r3, #788529152
 207 01f8 C229A0E1 		add	r3, r3, #8064
 208 01fc 2F34A0E3 		str	r3, [r2, #16]
 209 0200 7E3D83E2 		.loc 1 59 0
 210 0204 103082E5 		mov	r2, #-1610612736
  59:display.c     **** 	LCD_PORT->PIO_CODR = LCD_BUS;					// Port-Pins auf '0'
 211              	2, r2, asr #19
 212 0208 0A22A0E3 		mov	r3, #788529152
 213 020c C229A0E1 		add	r3, r3, #8064
 214 0210 2F34A0E3 		str	r3, [r2, #52]
 215 0214 7E3D83E2 		.loc 1 60 0
 216 0218 343082E5 		mov	r0, #14976
  60:display.c     **** 	delay1us(15000);								// 15ms warten
 217              	0, r0, #24
 218 021c EA0DA0E3 		bl	delay1us
 219 0220 180080E2 		.loc 1 61 0
 220 0224 FEFFFFEB 		mov	r0, #48
  61:display.c     **** 	lcd_write(0x30,0);								// Initialisierung 1. Mal
 221              		r1, #0
 222 0228 3000A0E3 		bl	lcd_write
 223 022c 0010A0E3 		.loc 1 62 0
 224 0230 FEFFFFEB 		mov	r0, #4096
  62:display.c     **** 	delay1us(4100);									// 4.1ms warten
 225              		r0, r0, #4
 226 0234 010AA0E3 		bl	delay1us
 227 0238 040080E2 		.loc 1 63 0
 228 023c FEFFFFEB 		mov	r0, #48
  63:display.c     **** 	lcd_write(0x30,0);								// Initialisierung 2. Mal
 229              		r1, #0
 230 0240 3000A0E3 		bl	lcd_write
 231 0244 0010A0E3 		.loc 1 64 0
 232 0248 FEFFFFEB 		mov	r0, #100
  64:display.c     **** 	delay1us(100);									// 100us warten
 233              	delay1us
 234 024c 6400A0E3 		.loc 1 65 0
 235 0250 FEFFFFEB 		mov	r0, #48
  65:display.c     **** 	lcd_write(0x30,0);								// Initialisierung 3. Mal
 236              	v	r1, #0
 237 0254 3000A0E3 		bl	lcd_write
 238 0258 0010A0E3 		.loc 1 66 0
 239 025c FEFFFFEB 		mov	r0, #56
  66:display.c     **** 	lcd_write(0x38,0);								// 8-Bit-Modus, 2/4-zeiliges Display, 5x7 Font
 240              		r1, #0
 241 0260 3800A0E3 		bl	lcd_write
 242 0264 0010A0E3 		.loc 1 67 0
 243 0268 FEFFFFEB 		mov	r0, #12
  67:display.c     **** 	lcd_write(0x0C,0);								// Display an, Cursor aus
 244              		r1, #0
 245 026c 0C00A0E3 		bl	lcd_write
 246 0270 0010A0E3 		.loc 1 68 0
 247 0274 FEFFFFEB 		mov	r0, #6
  68:display.c     **** 	lcd_write(0x06,0);								// Cursor inkrementieren und Scrollen ausschalten
 248              		r1, #0
 249 0278 0600A0E3 		bl	lcd_write
 250 027c 0010A0E3 		.loc 1 69 0
 251 0280 FEFFFFEB 		mov	r0, #1
  69:display.c     **** 	lcd_write(0x01,0);								// Display löschen
 252              		r1, #0
 253 0284 0100A0E3 		bl	lcd_write
 254 0288 0010A0E3 		.loc 1 70 0
 255 028c FEFFFFEB 		mov	r0, #4992
  70:display.c     **** 	delay1us(5000);									// 5ms warten
 256              		r0, r0, #8
 257 0290 4E0DA0E3 		bl	delay1us
 258 0294 080080E2 		.loc 1 71 0
 259 0298 FEFFFFEB 		ldmfd	sp, {fp, sp, pc}
  71:display.c     **** }
 260              	4:
 262              		.align	2
 263              		.global	display_putchar
 265              	display_putchar:
 266              	.LFB5:
 267              		.loc 1 78 0
 268              		@ args = 0, pretend = 0, frame = 4
  72:display.c     **** 
  73:display.c     **** //**************************************************************
  74:display.c     **** // UP-Name:			display_putchar(data)
  75:display.c     **** // Übergabewert:	auszugebenes Zeichen
  76:display.c     **** // Beschreibung:	gibt ein Zeichen auf dem LCD aus
  77:display.c     **** //**************************************************************
  78:display.c     **** void display_putchar(unsigned char data){
 269              	needed = 1, uses_anonymous_args = 0
 270              		mov	ip, sp
 271              	.LCFI7:
 272 02a0 0DC0A0E1 		stmfd	sp!, {fp, ip, lr, pc}
 273              	.LCFI8:
 274 02a4 00D82DE9 		sub	fp, ip, #4
 275              	.LCFI9:
 276 02a8 04B04CE2 		sub	sp, sp, #4
 277              	.LCFI10:
 278 02ac 04D04DE2 		mov	r3, r0
 279              		strb	r3, [fp, #-16]
 280 02b0 0030A0E1 		.loc 1 79 0
 281 02b4 10304BE5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
  79:display.c     **** 	lcd_write(data,1);
 282              	mov	r1, #1
 283 02b8 10305BE5 		bl	lcd_write
 284 02bc 0300A0E1 		.loc 1 80 0
 285 02c0 0110A0E3 		ldmfd	sp, {r3, fp, sp, pc}
 286 02c4 FEFFFFEB 	.LFE5:
  80:display.c     **** }
 287              	e	display_putchar, .-display_putchar
 288 02c8 08A89DE8 		.align	2
 289              		.global	display_putstr
 291              	display_putstr:
 292              	.LFB6:
 293              		.loc 1 87 0
 294              		@ args = 0, pretend = 0, frame = 4
 295              		@ frame_needed = 1, uses_anonymous_args = 0
  81:display.c     **** 
  82:display.c     **** //**************************************************************
  83:display.c     **** // UP-Name:			display_putstr(*p)
  84:display.c     **** // Übergabewert:	Die auszugebene Zeichenkette
  85:display.c     **** // Beschreibung:	gibt einen String auf dem LCD aus
  86:display.c     **** //**************************************************************
  87:display.c     **** void display_putstr(char *p){
 296              	sp
 297              	.LCFI11:
 298              		stmfd	sp!, {fp, ip, lr, pc}
 299 02cc 0DC0A0E1 	.LCFI12:
 300              		sub	fp, ip, #4
 301 02d0 00D82DE9 	.LCFI13:
 302              		sub	sp, sp, #4
 303 02d4 04B04CE2 	.LCFI14:
 304              		str	r0, [fp, #-16]
 305 02d8 04D04DE2 		b	.L20
 306              	.L21:
 307 02dc 10000BE5 		.loc 1 89 0
 308 02e0 060000EA 		ldr	r3, [fp, #-16]
 309              		ldrb	r3, [r3, #0]	@ zero_extendqisi2
  88:display.c     **** 	while(*p){
  89:display.c     **** 		display_putchar(*p);
 310              	l	display_putchar
 311 02e4 10301BE5 		.loc 1 90 0
 312 02e8 0030D3E5 		ldr	r3, [fp, #-16]
 313 02ec 0300A0E1 		add	r3, r3, #1
 314 02f0 FEFFFFEB 		str	r3, [fp, #-16]
  90:display.c     **** 		p++;
 315              	
 316 02f4 10301BE5 		.loc 1 88 0
 317 02f8 013083E2 		ldr	r3, [fp, #-16]
 318 02fc 10300BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 319              		cmp	r3, #0
 320              		bne	.L21
 321 0300 10301BE5 		.loc 1 92 0
 322 0304 0030D3E5 		ldmfd	sp, {r3, fp, sp, pc}
 323 0308 000053E3 	.LFE6:
  91:display.c     **** 	}
  92:display.c     **** }
 325              	
 326 0310 08A89DE8 		.global	display_set_cursor
 328              	display_set_cursor:
 329              	.LFB7:
 330              		.loc 1 101 0
 331              		@ args = 0, pretend = 0, frame = 8
 332              		@ frame_needed = 1, uses_anonymous_args = 0
 333              		mov	ip, sp
  93:display.c     **** 
  94:display.c     **** //**************************************************************
  95:display.c     **** // UP-Name:			display_set_cursor()
  96:display.c     **** // Übergabewert:	x-Position, y-Position
  97:display.c     **** // Beschreibung:	stellt Cursor an Position x,y (Spalte,Zeile)
  98:display.c     **** // 					Für x ist Wert zwischen 0 und 15 erlaubt.
  99:display.c     **** // 					Für y ist 0 (1.Zeile) + 1 (2.Zeile) erlaubt.
 100:display.c     **** //**************************************************************
 101:display.c     **** void display_set_cursor(unsigned char x, unsigned char y){
 334              	
 335              		stmfd	sp!, {fp, ip, lr, pc}
 336              	.LCFI16:
 337 0314 0DC0A0E1 		sub	fp, ip, #4
 338              	.LCFI17:
 339 0318 00D82DE9 		sub	sp, sp, #8
 340              	.LCFI18:
 341 031c 04B04CE2 		mov	r3, r0
 342              		mov	r2, r1
 343 0320 08D04DE2 		strb	r3, [fp, #-16]
 344              		mov	r3, r2
 345 0324 0030A0E1 		strb	r3, [fp, #-20]
 346 0328 0120A0E1 		.loc 1 102 0
 347 032c 10304BE5 		ldrb	r3, [fp, #-20]	@ zero_extendqisi2
 348 0330 0230A0E1 		add	r3, r3, #2
 349 0334 14304BE5 		mov	r3, r3, asl #6
 102:display.c     ****   lcd_write((0x80 + y*0x40 + x),0);
 350              	55
 351 0338 14305BE5 		ldrb	r3, [fp, #-16]
 352 033c 023083E2 		add	r3, r2, r3
 353 0340 0333A0E1 		and	r3, r3, #255
 354 0344 FF2003E2 		mov	r0, r3
 355 0348 10305BE5 		mov	r1, #0
 356 034c 033082E0 		bl	lcd_write
 357 0350 FF3003E2 		.loc 1 103 0
 358 0354 0300A0E1 		sub	sp, fp, #12
 359 0358 0010A0E3 		ldmfd	sp, {fp, sp, pc}
 360 035c FEFFFFEB 	.LFE7:
 103:display.c     **** }
 361              	lay_set_cursor, .-display_set_cursor
 362 0360 0CD04BE2 		.section	.rodata
 363 0364 00A89DE8 		.align	2
 364              	.LC0:
 365              		.ascii	"                \000"
 366              		.text
 367              		.align	2
 368              		.global	display_clear
 370              	display_clear:
 371              	.LFB8:
 372              		.loc 1 105 0
 373              		@ args = 0, pretend = 0, frame = 4
 374              		@ frame_needed = 1, uses_anonymous_args = 0
 375              		mov	ip, sp
 104:display.c     **** 
 105:display.c     **** void display_clear() {
 376              		sp!, {fp, ip, lr, pc}
 377              	.LCFI20:
 378              		sub	fp, ip, #4
 379 0368 0DC0A0E1 	.LCFI21:
 380              		sub	sp, sp, #4
 381 036c 00D82DE9 	.LCFI22:
 382              		.loc 1 106 0
 383 0370 04B04CE2 		ldr	r3, .L27
 384              		str	r3, [fp, #-16]
 385 0374 04D04DE2 		.loc 1 107 0
 386              		mov	r0, #0
 106:display.c     **** 	char *clear = "                ";
 387              	
 388 0378 2C309FE5 		bl	display_set_cursor
 389 037c 10300BE5 		.loc 1 108 0
 107:display.c     **** 	display_set_cursor(0,0);
 390              	dr	r0, [fp, #-16]
 391 0380 0000A0E3 		bl	display_putstr
 392 0384 0010A0E3 		.loc 1 109 0
 393 0388 FEFFFFEB 		ldr	r0, [fp, #-16]
 108:display.c     **** 	display_putstr(clear);
 394              	display_putstr
 395 038c 10001BE5 		.loc 1 110 0
 396 0390 FEFFFFEB 		mov	r0, #0
 109:display.c     **** 	display_putstr(clear);
 397              	v	r1, #0
 398 0394 10001BE5 		bl	display_set_cursor
 399 0398 FEFFFFEB 		.loc 1 111 0
 110:display.c     **** 	display_set_cursor(0,0);
 400              	mfd	sp, {r3, fp, sp, pc}
 401 039c 0000A0E3 	.L28:
 402 03a0 0010A0E3 		.align	2
 403 03a4 FEFFFFEB 	.L27:
 111:display.c     **** }
 404              	rd	.LC0
 405 03a8 08A89DE8 	.LFE8:
 407              		.section	.rodata
 408              		.align	2
 409 03ac 00000000 	.LC1:
 410              		.ascii	"0123456789abcdef\000"
 411              		.text
 412              		.align	2
 413 0011 000000   		.global	display_printf
 415 0014 30313233 	display_printf:
 415      34353637 
 415      38396162 
 415      63646566 
 415      00
 416 0025 000000   	.LFB9:
 417              		.loc 1 123 0
 418              		@ args = 4, pretend = 16, frame = 68
 419              		@ frame_needed = 1, uses_anonymous_args = 1
 420              		mov	ip, sp
 421              	.LCFI23:
 112:display.c     **** 
 113:display.c     **** //**************************************************************
 114:display.c     **** // Up-Name:			display_printf()
 115:display.c     **** // Beschreibung:	schreibt einen String ins LCD-Display. Die
 116:display.c     **** //					Anzahl der Argumente ist beliebig.
 117:display.c     **** //					display_printf() interpretiert in der
 118:display.c     **** //					eingeschränkten Funktionalität aber nur
 119:display.c     **** //					Variablen des Types Int: '%d' und Hex: '%x'
 120:display.c     **** //					Für volle Funktionalität muss der Ausdruck
 121:display.c     **** //					FULL_PRINTF == 1 in angegeben sein.
 122:display.c     **** //**************************************************************
 123:display.c     **** void display_printf(char *string,...){
 422              	1, r2, r3}
 423              	.LCFI24:
 424              		stmfd	sp!, {r4, fp, ip, lr, pc}
 425 03b0 0DC0A0E1 	.LCFI25:
 426              		sub	fp, ip, #20
 427 03b4 0F002DE9 	.LCFI26:
 428              		sub	sp, sp, #68
 429 03b8 10D82DE9 	.LCFI27:
 430              		.loc 1 129 0
 431 03bc 14B04CE2 		ldr	r3, .L55
 432              		sub	r2, fp, #74
 433 03c0 44D04DE2 		mov	ip, #17
 434              		mov	r0, r2
 124:display.c     **** 	char buffer1[20];								// Puffer für Formatstring
 125:display.c     **** 	unsigned char i;								// Laufvariable
 126:display.c     **** #if FULL_PRINTF == 1
 127:display.c     **** 	char buffer2[17];								// Puffer für sprintf
 128:display.c     **** #else
 129:display.c     **** 	char Tabelle[]="0123456789abcdef";				// Tabelle für Konvertierung
 435              	mov	r2, ip
 436 03c4 6C369FE5 		bl	memcpy
 437 03c8 4A204BE2 		.loc 1 137 0
 438 03cc 11C0A0E3 		add	r3, fp, #8
 439 03d0 0200A0E1 		str	r3, [fp, #-80]
 440 03d4 0310A0E1 		.loc 1 138 0
 441 03d8 0C20A0E1 		ldr	r3, [fp, #4]
 442 03dc FEFFFFEB 		str	r3, [fp, #-20]
 130:display.c     **** 	unsigned int ui;								// Vorzeichenlose Variable
 131:display.c     **** 	signed int si;									// Vorzeichenbehaftete Variable
 132:display.c     **** 	double d;										// Variable Typ 'double'
 133:display.c     **** #endif
 134:display.c     **** 	va_list	ap;										// Argumentenpointer
 135:display.c     **** 	char *p;										// Pointer auf String
 136:display.c     **** 
 137:display.c     **** 	va_start(ap,string);							// Start variable Argumentenliste
 443              	.L53:
 444 03e0 08308BE2 		.loc 1 139 0
 445 03e4 50300BE5 		ldr	r3, [fp, #-20]
 138:display.c     **** 	for (p=string; *p; p++){						// Umwandlungsangaben suchen
 446              	rb	r3, [r3, #0]	@ zero_extendqisi2
 447 03e8 04309BE5 		cmp	r3, #37
 448 03ec 14300BE5 		bne	.L31
 449 03f0 8A0100EA 		.loc 1 140 0
 450              		mov	r3, #0
 139:display.c     **** 		if (*p == '%'){								// Beginn der Umwandlungsangabe
 451              		r3, [fp, #-37]
 452 03f4 14301BE5 	.L33:
 453 03f8 0030D3E5 		.loc 1 142 0
 454 03fc 250053E3 		ldrb	r1, [fp, #-37]	@ zero_extendqisi2
 455 0400 7F01001A 		ldr	r3, [fp, #-20]
 140:display.c     **** 			i=0;									// Startwert
 456              		r0, [r3, #0]	@ zero_extendqisi2
 457 0404 0030A0E3 		mvn	r2, #40
 458 0408 25304BE5 		sub	ip, fp, #16
 459              		add	r3, ip, r1
 141:display.c     **** 			do {									// Ende der Umwandlungsangabe; Umwandlung in:
 142:display.c     **** 				buffer1[i++] = *p++;				// Umwandlungsstring wird im Puffer abgelegt
 460              		r2, r3, r2
 461 040c 25105BE5 		mov	r3, r0
 462 0410 14301BE5 		strb	r3, [r2, #0]
 463 0414 0000D3E5 		ldrb	r3, [fp, #-37]
 464 0418 2820E0E3 		add	r3, r3, #1
 465 041c 10C04BE2 		strb	r3, [fp, #-37]
 466 0420 01308CE0 		ldr	r3, [fp, #-20]
 467 0424 022083E0 		add	r3, r3, #1
 468 0428 0030A0E1 		str	r3, [fp, #-20]
 469 042c 0030C2E5 		.loc 1 143 0
 470 0430 25305BE5 		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 471 0434 013083E2 		cmp	r3, #18
 472 0438 25304BE5 		bls	.L32
 473 043c 14301BE5 		mov	r3, #18
 474 0440 013083E2 		strb	r3, [fp, #-37]
 475 0444 14300BE5 	.L32:
 143:display.c     **** 				if (i>18) i=18;						// Damit es keinen Bufferoverflow gibt
 476              	dr	r3, [fp, #-20]
 477 0448 25305BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 478 044c 120053E3 		cmp	r3, #100
 479 0450 0100009A 		movne	r3, #0
 480 0454 1230A0E3 		moveq	r3, #1
 481 0458 25304BE5 		and	r2, r3, #255
 482              		ldr	r3, [fp, #-20]
 144:display.c     **** 				}while(!((*p=='d')|(*p=='i')|		// dezimal mit Vorzeichen
 483              	3, [r3, #0]	@ zero_extendqisi2
 484 045c 14301BE5 		cmp	r3, #105
 485 0460 0030D3E5 		movne	r3, #0
 486 0464 640053E3 		moveq	r3, #1
 487 0468 0030A013 		and	r3, r3, #255
 488 046c 0130A003 		orr	r3, r2, r3
 489 0470 FF2003E2 		and	r3, r3, #255
 490 0474 14301BE5 		mov	r2, r3
 491 0478 0030D3E5 		ldr	r3, [fp, #-20]
 492 047c 690053E3 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 493 0480 0030A013 		cmp	r3, #111
 494 0484 0130A003 		movne	r3, #0
 495 0488 FF3003E2 		moveq	r3, #1
 496 048c 033082E1 		orr	r2, r2, r3
 497 0490 FF3003E2 		ldr	r3, [fp, #-20]
 498 0494 0320A0E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 499 0498 14301BE5 		cmp	r3, #120
 500 049c 0030D3E5 		movne	r3, #0
 501 04a0 6F0053E3 		moveq	r3, #1
 502 04a4 0030A013 		orr	r2, r2, r3
 503 04a8 0130A003 		ldr	r3, [fp, #-20]
 504 04ac 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 505 04b0 14301BE5 		cmp	r3, #88
 506 04b4 0030D3E5 		movne	r3, #0
 507 04b8 780053E3 		moveq	r3, #1
 508 04bc 0030A013 		orr	r2, r2, r3
 509 04c0 0130A003 		ldr	r3, [fp, #-20]
 510 04c4 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 511 04c8 14301BE5 		cmp	r3, #117
 512 04cc 0030D3E5 		movne	r3, #0
 513 04d0 580053E3 		moveq	r3, #1
 514 04d4 0030A013 		orr	r2, r2, r3
 515 04d8 0130A003 		ldr	r3, [fp, #-20]
 516 04dc 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 517 04e0 14301BE5 		cmp	r3, #99
 518 04e4 0030D3E5 		movne	r3, #0
 519 04e8 750053E3 		moveq	r3, #1
 520 04ec 0030A013 		orr	r2, r2, r3
 521 04f0 0130A003 		ldr	r3, [fp, #-20]
 522 04f4 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 523 04f8 14301BE5 		cmp	r3, #115
 524 04fc 0030D3E5 		movne	r3, #0
 525 0500 630053E3 		moveq	r3, #1
 526 0504 0030A013 		orr	r2, r2, r3
 527 0508 0130A003 		ldr	r3, [fp, #-20]
 528 050c 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 529 0510 14301BE5 		cmp	r3, #102
 530 0514 0030D3E5 		movne	r3, #0
 531 0518 730053E3 		moveq	r3, #1
 532 051c 0030A013 		orr	r2, r2, r3
 533 0520 0130A003 		ldr	r3, [fp, #-20]
 534 0524 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 535 0528 14301BE5 		cmp	r3, #101
 536 052c 0030D3E5 		movne	r3, #0
 537 0530 660053E3 		moveq	r3, #1
 538 0534 0030A013 		orr	r2, r2, r3
 539 0538 0130A003 		ldr	r3, [fp, #-20]
 540 053c 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 541 0540 14301BE5 		cmp	r3, #69
 542 0544 0030D3E5 		movne	r3, #0
 543 0548 650053E3 		moveq	r3, #1
 544 054c 0030A013 		orr	r2, r2, r3
 545 0550 0130A003 		ldr	r3, [fp, #-20]
 546 0554 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 547 0558 14301BE5 		cmp	r3, #103
 548 055c 0030D3E5 		movne	r3, #0
 549 0560 450053E3 		moveq	r3, #1
 550 0564 0030A013 		orr	r2, r2, r3
 551 0568 0130A003 		ldr	r3, [fp, #-20]
 552 056c 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 553 0570 14301BE5 		cmp	r3, #71
 554 0574 0030D3E5 		movne	r3, #0
 555 0578 670053E3 		moveq	r3, #1
 556 057c 0030A013 		orr	r2, r2, r3
 557 0580 0130A003 		ldr	r3, [fp, #-20]
 558 0584 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 559 0588 14301BE5 		cmp	r3, #37
 560 058c 0030D3E5 		movne	r3, #0
 561 0590 470053E3 		moveq	r3, #1
 562 0594 0030A013 		orr	r3, r2, r3
 563 0598 0130A003 		.loc 1 153 0
 564 059c 032082E1 		cmp	r3, #0
 565 05a0 14301BE5 		beq	.L33
 566 05a4 0030D3E5 		.loc 1 154 0
 567 05a8 250053E3 		ldrb	r1, [fp, #-37]	@ zero_extendqisi2
 568 05ac 0030A013 		ldr	r3, [fp, #-20]
 569 05b0 0130A003 		ldrb	r0, [r3, #0]	@ zero_extendqisi2
 570 05b4 033082E1 		mvn	r2, #40
 145:display.c     **** 						 (*p=='o')|					// oktal
 146:display.c     **** 						 (*p=='x')|(*p=='X')|		// hexadezimal
 147:display.c     **** 						 (*p=='u')|					// dezimal ohne Vorzeichen
 148:display.c     **** 						 (*p=='c')|					// einzelnes Zeichen
 149:display.c     **** 						 (*p=='s')|					// string
 150:display.c     **** 						 (*p=='f')|					// float
 151:display.c     **** 						 (*p=='e')|(*p=='E')|		// Gleitpunktzahl
 152:display.c     **** 						 (*p=='g')|(*p=='G')|		// Gleitpunktzahl
 153:display.c     **** 						 (*p=='%')));				// '%'
 571              	, [fp, #-37]
 572 05b8 000053E3 		add	r3, r3, #1
 573 05bc 92FFFF0A 		strb	r3, [fp, #-37]
 154:display.c     **** 			buffer1[i++] = *p;						// nun noch die Angabe des Umwandlungswertes
 574              	oc 1 155 0
 575 05c0 25105BE5 		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 576 05c4 14301BE5 		mvn	r2, #40
 577 05c8 0000D3E5 		sub	r1, fp, #16
 578 05cc 2820E0E3 		add	r3, r1, r3
 579 05d0 10C04BE2 		add	r2, r3, r2
 580 05d4 01308CE0 		mov	r3, #0
 581 05d8 022083E0 		strb	r3, [r2, #0]
 582 05dc 0030A0E1 		.loc 1 175 0
 583 05e0 0030C2E5 		ldr	r3, [fp, #-20]
 584 05e4 25305BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 585 05e8 013083E2 		cmp	r3, #100
 586 05ec 25304BE5 		movne	r3, #0
 155:display.c     **** 			buffer1[i] = 0;							// hiermit ist der Puffer abgeschlossen
 587              	
 588 05f0 25305BE5 		and	r2, r3, #255
 589 05f4 2820E0E3 		ldr	r3, [fp, #-20]
 590 05f8 10104BE2 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 591 05fc 033081E0 		cmp	r3, #105
 592 0600 022083E0 		movne	r3, #0
 593 0604 0030A0E3 		moveq	r3, #1
 594 0608 0030C2E5 		and	r3, r3, #255
 156:display.c     **** // Ab hier: wahlweise mit voller PRINTF-Funktionalität
 157:display.c     **** #if FULL_PRINTF == 1
 158:display.c     **** 			if ((*p=='d')|(*p == 'i') |				// Argument ist Typ 'int'
 159:display.c     **** 				(*p=='o')|
 160:display.c     **** 				(*p=='x')|(*p == 'X') |
 161:display.c     **** 				(*p=='u')|
 162:display.c     **** 				(*p=='c')|
 163:display.c     **** 				(*p=='s')){
 164:display.c     **** 				snprintf(buffer2,17,buffer1,va_arg(ap,int));
 165:display.c     **** 				display_putstr(buffer2);
 166:display.c     **** 			}
 167:display.c     **** 			if ((*p=='f')|							// Argument ist Typ 'double'
 168:display.c     **** 				(*p=='e')|(*p=='E')|
 169:display.c     **** 				(*p=='g')|(*p=='G')){
 170:display.c     **** 				snprintf(buffer2,17,buffer1,va_arg(ap,double));
 171:display.c     **** 				display_putstr(buffer2);
 172:display.c     **** 				}
 173:display.c     **** // Ab hier: ... oder mit eingeschränkter PRINTF-Funktionalität
 174:display.c     **** #else
 175:display.c     **** 			if ((*p=='d')|(*p == 'i')){				// Ausgabe als vorzeichenbehaftete Zahl
 595              	, r2, r3
 596 060c 14301BE5 		and	r3, r3, #255
 597 0610 0030D3E5 		cmp	r3, #0
 598 0614 640053E3 		beq	.L34
 599 0618 0030A013 		.loc 1 176 0
 600 061c 0130A003 		ldr	r2, [fp, #-80]
 601 0620 FF2003E2 		add	r3, r2, #4
 602 0624 14301BE5 		str	r3, [fp, #-80]
 603 0628 0030D3E5 		mov	r3, r2
 604 062c 690053E3 		ldr	r3, [r3, #0]
 605 0630 0030A013 		str	r3, [fp, #-32]
 606 0634 0130A003 		.loc 1 177 0
 607 0638 FF3003E2 		ldr	r3, [fp, #-32]
 608 063c 033082E1 		cmp	r3, #0
 609 0640 FF3003E2 		bge	.L35
 610 0644 000053E3 		.loc 1 178 0
 611 0648 4F00000A 		mov	r0, #45
 176:display.c     **** 				si = va_arg(ap,int);
 612              	ar
 613 064c 50201BE5 		.loc 1 179 0
 614 0650 043082E2 		ldr	r3, [fp, #-32]
 615 0654 50300BE5 		rsb	r3, r3, #0
 616 0658 0230A0E1 		str	r3, [fp, #-32]
 617 065c 003093E5 	.L35:
 618 0660 20300BE5 		.loc 1 181 0
 177:display.c     **** 				if (si < 0){
 619              	, [fp, #-32]
 620 0664 20301BE5 		cmp	r3, #0
 621 0668 000053E3 		bne	.L36
 622 066c 040000AA 		.loc 1 182 0
 178:display.c     **** 					display_putchar('-');
 623              		r0, #48
 624 0670 2D00A0E3 		bl	display_putchar
 625 0674 FEFFFFEB 		b	.L34
 179:display.c     **** 					si=-si;
 626              	6:
 627 0678 20301BE5 		.loc 1 185 0
 628 067c 003063E2 		mov	r3, #15
 629 0680 20300BE5 		strb	r3, [fp, #-37]
 630              		b	.L37
 180:display.c     **** 				}
 181:display.c     **** 				if (si==0){
 631              	
 632 0684 20301BE5 		.loc 1 186 0
 633 0688 000053E3 		ldrb	r0, [fp, #-37]	@ zero_extendqisi2
 634 068c 0200001A 		ldr	r1, [fp, #-32]
 182:display.c     **** 					display_putchar('0');
 635              	r	r3, .L55+4
 636 0690 3000A0E3 		smull	r2, r3, r1, r3
 637 0694 FEFFFFEB 		mov	r2, r3, asr #2
 638 0698 3B0000EA 		mov	r3, r1, asr #31
 639              		rsb	r3, r3, r2
 183:display.c     **** 				}
 184:display.c     **** 				else{
 185:display.c     **** 					for (i = 15; i && si; --i){
 640              	r3, [fp, #-84]
 641 069c 0F30A0E3 		ldr	r3, [fp, #-84]
 642 06a0 25304BE5 		mov	r3, r3, asl #1
 643 06a4 230000EA 		mov	r2, r3, asl #2
 644              		add	r3, r3, r2
 186:display.c     **** 						buffer1[i] = Tabelle[(si%10)];
 645              	r3, r3, r1
 646 06a8 25005BE5 		str	r3, [fp, #-84]
 647 06ac 20101BE5 		mvn	r2, #57
 648 06b0 84339FE5 		sub	ip, fp, #16
 649 06b4 9123C3E0 		ldr	r1, [fp, #-84]
 650 06b8 4321A0E1 		add	r3, ip, r1
 651 06bc C13FA0E1 		add	r3, r3, r2
 652 06c0 023063E0 		ldrb	r1, [r3, #0]	@ zero_extendqisi2
 653 06c4 54300BE5 		mvn	r2, #40
 654 06c8 54301BE5 		sub	ip, fp, #16
 655 06cc 8330A0E1 		add	r3, ip, r0
 656 06d0 0321A0E1 		add	r2, r3, r2
 657 06d4 023083E0 		mov	r3, r1
 658 06d8 013063E0 		strb	r3, [r2, #0]
 659 06dc 54300BE5 		.loc 1 187 0
 660 06e0 3920E0E3 		ldr	r1, [fp, #-32]
 661 06e4 10C04BE2 		ldr	r3, .L55+4
 662 06e8 54101BE5 		smull	r2, r3, r1, r3
 663 06ec 01308CE0 		mov	r2, r3, asr #2
 664 06f0 023083E0 		mov	r3, r1, asr #31
 665 06f4 0010D3E5 		rsb	r3, r3, r2
 666 06f8 2820E0E3 		str	r3, [fp, #-32]
 667 06fc 10C04BE2 		.loc 1 185 0
 668 0700 00308CE0 		ldrb	r3, [fp, #-37]
 669 0704 022083E0 		sub	r3, r3, #1
 670 0708 0130A0E1 		strb	r3, [fp, #-37]
 671 070c 0030C2E5 	.L37:
 187:display.c     **** 						si /= 10;
 672              	_extendqisi2
 673 0710 20101BE5 		cmp	r3, #0
 674 0714 20339FE5 		beq	.L40
 675 0718 9123C3E0 		ldr	r3, [fp, #-32]
 676 071c 4321A0E1 		cmp	r3, #0
 677 0720 C13FA0E1 		bne	.L39
 678 0724 023063E0 		b	.L40
 679 0728 20300BE5 	.L41:
 680              		.loc 1 189 0
 681 072c 25305BE5 		ldrb	r3, [fp, #-37]
 682 0730 013043E2 		add	r3, r3, #1
 683 0734 25304BE5 		strb	r3, [fp, #-37]
 684              		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 685 0738 25305BE5 		mvn	r2, #40
 686 073c 000053E3 		sub	ip, fp, #16
 687 0740 0E00000A 		add	r3, ip, r3
 688 0744 20301BE5 		add	r3, r3, r2
 689 0748 000053E3 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 690 074c D5FFFF1A 		mov	r0, r3
 691 0750 0A0000EA 		bl	display_putchar
 692              	.L40:
 188:display.c     **** 					}
 189:display.c     **** 					for (; i < 15; display_putchar(buffer1[++i]));
 693              	@ zero_extendqisi2
 694 0754 25305BE5 		cmp	r3, #14
 695 0758 013083E2 		bls	.L41
 696 075c 25304BE5 	.L34:
 697 0760 25305BE5 		.loc 1 192 0
 698 0764 2820E0E3 		ldr	r3, [fp, #-20]
 699 0768 10C04BE2 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 700 076c 03308CE0 		cmp	r3, #120
 701 0770 023083E0 		movne	r3, #0
 702 0774 0030D3E5 		moveq	r3, #1
 703 0778 0300A0E1 		and	r2, r3, #255
 704 077c FEFFFFEB 		ldr	r3, [fp, #-20]
 705              		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 706 0780 25305BE5 		cmp	r3, #88
 707 0784 0E0053E3 		movne	r3, #0
 708 0788 F1FFFF9A 		moveq	r3, #1
 709              		and	r3, r3, #255
 190:display.c     **** 				}
 191:display.c     **** 			}
 192:display.c     **** 			if ((*p=='x')|(*p == 'X')){				// Ausgabe als hexadezimale Zahl
 710              	and	r3, r3, #255
 711 078c 14301BE5 		cmp	r3, #0
 712 0790 0030D3E5 		beq	.L42
 713 0794 780053E3 		.loc 1 193 0
 714 0798 0030A013 		ldr	r2, [fp, #-80]
 715 079c 0130A003 		add	r3, r2, #4
 716 07a0 FF2003E2 		str	r3, [fp, #-80]
 717 07a4 14301BE5 		mov	r3, r2
 718 07a8 0030D3E5 		ldr	r3, [r3, #0]
 719 07ac 580053E3 		str	r3, [fp, #-36]
 720 07b0 0030A013 		.loc 1 194 0
 721 07b4 0130A003 		ldr	r3, [fp, #-36]
 722 07b8 FF3003E2 		cmp	r3, #0
 723 07bc 033082E1 		bne	.L43
 724 07c0 FF3003E2 		.loc 1 195 0
 725 07c4 000053E3 		mov	r0, #48
 726 07c8 3700000A 		bl	display_putchar
 193:display.c     **** 				ui = va_arg(ap,unsigned int);
 727              	oc 1 198 0
 728 07cc 50201BE5 		mov	r3, #15
 729 07d0 043082E2 		strb	r3, [fp, #-37]
 730 07d4 50300BE5 		b	.L44
 731 07d8 0230A0E1 	.L46:
 732 07dc 003093E5 		.loc 1 199 0
 733 07e0 24300BE5 		ldrb	r0, [fp, #-37]	@ zero_extendqisi2
 194:display.c     **** 				if (ui==0){
 734              	, [fp, #-36]
 735 07e4 24301BE5 		and	r3, r3, #15
 736 07e8 000053E3 		mvn	r2, #57
 737 07ec 0200001A 		sub	r1, fp, #16
 195:display.c     **** 					display_putchar('0');
 738              		r3, r1, r3
 739 07f0 3000A0E3 		add	r3, r3, r2
 740 07f4 FEFFFFEB 		ldrb	r1, [r3, #0]	@ zero_extendqisi2
 741 07f8 2B0000EA 		mvn	r2, #40
 742              		sub	ip, fp, #16
 196:display.c     **** 				}
 197:display.c     **** 				else{
 198:display.c     **** 					for (i = 15; i && ui; --i){
 743              	r3, ip, r0
 744 07fc 0F30A0E3 		add	r2, r3, r2
 745 0800 25304BE5 		mov	r3, r1
 746 0804 130000EA 		strb	r3, [r2, #0]
 747              		.loc 1 200 0
 199:display.c     **** 						buffer1[i] = Tabelle[(ui%16)];
 748              	r3, [fp, #-36]
 749 0808 25005BE5 		mov	r3, r3, lsr #4
 750 080c 24301BE5 		str	r3, [fp, #-36]
 751 0810 0F3003E2 		.loc 1 198 0
 752 0814 3920E0E3 		ldrb	r3, [fp, #-37]
 753 0818 10104BE2 		sub	r3, r3, #1
 754 081c 033081E0 		strb	r3, [fp, #-37]
 755 0820 023083E0 	.L44:
 756 0824 0010D3E5 		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 757 0828 2820E0E3 		cmp	r3, #0
 758 082c 10C04BE2 		beq	.L47
 759 0830 00308CE0 		ldr	r3, [fp, #-36]
 760 0834 022083E0 		cmp	r3, #0
 761 0838 0130A0E1 		bne	.L46
 762 083c 0030C2E5 		b	.L47
 200:display.c     **** 						ui /= 16;
 763              	02 0
 764 0840 24301BE5 		ldrb	r3, [fp, #-37]
 765 0844 2332A0E1 		add	r3, r3, #1
 766 0848 24300BE5 		strb	r3, [fp, #-37]
 767              		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 768 084c 25305BE5 		mvn	r2, #40
 769 0850 013043E2 		sub	r1, fp, #16
 770 0854 25304BE5 		add	r3, r1, r3
 771              		add	r3, r3, r2
 772 0858 25305BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 773 085c 000053E3 		mov	r0, r3
 774 0860 0E00000A 		bl	display_putchar
 775 0864 24301BE5 	.L47:
 776 0868 000053E3 		ldrb	r3, [fp, #-37]	@ zero_extendqisi2
 777 086c E5FFFF1A 		cmp	r3, #14
 778 0870 0A0000EA 		bls	.L48
 779              	.L42:
 201:display.c     **** 					}
 202:display.c     **** 					for (; i < 15; display_putchar(buffer1[++i]));
 780              	r	r3, [fp, #-20]
 781 0874 25305BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 782 0878 013083E2 		cmp	r3, #111
 783 087c 25304BE5 		movne	r3, #0
 784 0880 25305BE5 		moveq	r3, #1
 785 0884 2820E0E3 		and	r2, r3, #255
 786 0888 10104BE2 		ldr	r3, [fp, #-20]
 787 088c 033081E0 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 788 0890 023083E0 		cmp	r3, #117
 789 0894 0030D3E5 		movne	r3, #0
 790 0898 0300A0E1 		moveq	r3, #1
 791 089c FEFFFFEB 		and	r3, r3, #255
 792              		orr	r3, r2, r3
 793 08a0 25305BE5 		and	r3, r3, #255
 794 08a4 0E0053E3 		mov	r2, r3
 795 08a8 F1FFFF9A 		ldr	r3, [fp, #-20]
 796              		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 203:display.c     **** 				}
 204:display.c     **** 			}
 205:display.c     **** 			if ((*p=='o')|							// Unbekannter Typ; Ausgabe wird übersprungen
 797              	ne	r3, #0
 798 08ac 14301BE5 		moveq	r3, #1
 799 08b0 0030D3E5 		orr	r2, r2, r3
 800 08b4 6F0053E3 		ldr	r3, [fp, #-20]
 801 08b8 0030A013 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 802 08bc 0130A003 		cmp	r3, #115
 803 08c0 FF2003E2 		movne	r3, #0
 804 08c4 14301BE5 		moveq	r3, #1
 805 08c8 0030D3E5 		orr	r3, r2, r3
 806 08cc 750053E3 		cmp	r3, #0
 807 08d0 0030A013 		beq	.L49
 808 08d4 0130A003 		.loc 1 209 0
 809 08d8 FF3003E2 		ldr	r2, [fp, #-80]
 810 08dc 033082E1 		add	r3, r2, #4
 811 08e0 FF3003E2 		str	r3, [fp, #-80]
 812 08e4 0320A0E1 		mov	r3, r2
 813 08e8 14301BE5 		ldr	r3, [r3, #0]
 814 08ec 0030D3E5 		str	r3, [fp, #-36]
 815 08f0 630053E3 	.L49:
 816 08f4 0030A013 		.loc 1 211 0
 817 08f8 0130A003 		ldr	r3, [fp, #-20]
 818 08fc 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 819 0900 14301BE5 		cmp	r3, #102
 820 0904 0030D3E5 		movne	r3, #0
 821 0908 730053E3 		moveq	r3, #1
 822 090c 0030A013 		and	r2, r3, #255
 823 0910 0130A003 		ldr	r3, [fp, #-20]
 824 0914 033082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 825 0918 000053E3 		cmp	r3, #101
 826 091c 0500000A 		movne	r3, #0
 206:display.c     **** 				(*p=='u')|
 207:display.c     **** 				(*p=='c')|
 208:display.c     **** 				(*p=='s')){
 209:display.c     **** 				ui = va_arg(ap,unsigned int);
 827              	5
 828 0920 50201BE5 		orr	r3, r2, r3
 829 0924 043082E2 		and	r3, r3, #255
 830 0928 50300BE5 		mov	r2, r3
 831 092c 0230A0E1 		ldr	r3, [fp, #-20]
 832 0930 003093E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 833 0934 24300BE5 		cmp	r3, #69
 834              		movne	r3, #0
 210:display.c     **** 			}
 211:display.c     **** 			if ((*p=='f')|							// Unbekannter Typ; Ausgabe wird übersprungen
 835              	3, #1
 836 0938 14301BE5 		orr	r2, r2, r3
 837 093c 0030D3E5 		ldr	r3, [fp, #-20]
 838 0940 660053E3 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 839 0944 0030A013 		cmp	r3, #103
 840 0948 0130A003 		movne	r3, #0
 841 094c FF2003E2 		moveq	r3, #1
 842 0950 14301BE5 		orr	r2, r2, r3
 843 0954 0030D3E5 		ldr	r3, [fp, #-20]
 844 0958 650053E3 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 845 095c 0030A013 		cmp	r3, #71
 846 0960 0130A003 		movne	r3, #0
 847 0964 FF3003E2 		moveq	r3, #1
 848 0968 033082E1 		orr	r3, r2, r3
 849 096c FF3003E2 		cmp	r3, #0
 850 0970 0320A0E1 		beq	.L50
 851 0974 14301BE5 		.loc 1 214 0
 852 0978 0030D3E5 		ldr	r2, [fp, #-80]
 853 097c 450053E3 		add	r3, r2, #8
 854 0980 0030A013 		str	r3, [fp, #-80]
 855 0984 0130A003 		mov	r3, r2
 856 0988 032082E1 		ldmia	r3, {r3-r4}
 857 098c 14301BE5 		str	r3, [fp, #-28]
 858 0990 0030D3E5 		str	r4, [fp, #-24]
 859 0994 670053E3 	.L50:
 860 0998 0030A013 		.loc 1 218 0
 861 099c 0130A003 		ldr	r3, [fp, #-20]
 862 09a0 032082E1 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 863 09a4 14301BE5 		cmp	r3, #37
 864 09a8 0030D3E5 		bne	.L52
 865 09ac 470053E3 		ldr	r3, [fp, #-20]
 866 09b0 0030A013 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 867 09b4 0130A003 		mov	r0, r3
 868 09b8 033082E1 		bl	display_putchar
 869 09bc 000053E3 		b	.L52
 870 09c0 0600000A 	.L31:
 212:display.c     **** 				(*p=='e')|(*p=='E')|
 213:display.c     **** 				(*p=='g')|(*p=='G')){
 214:display.c     **** 				d = va_arg(ap,double);
 871              	drb	r3, [r3, #0]	@ zero_extendqisi2
 872 09c4 50201BE5 		mov	r0, r3
 873 09c8 083082E2 		bl	display_putchar
 874 09cc 50300BE5 	.L52:
 875 09d0 0230A0E1 		.loc 1 138 0
 876 09d4 180093E8 		ldr	r3, [fp, #-20]
 877 09d8 1C300BE5 		add	r3, r3, #1
 878 09dc 18400BE5 		str	r3, [fp, #-20]
 879              	.L30:
 215:display.c     **** 			}
 216:display.c     **** // Ab hier: wieder für beide Versionen
 217:display.c     **** #endif
 218:display.c     **** 			if ((*p == '%')) display_putchar(*p);	// Argument ist '%'
 880              	[fp, #-20]
 881 09e0 14301BE5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 882 09e4 0030D3E5 		cmp	r3, #0
 883 09e8 250053E3 		bne	.L53
 884 09ec 0800001A 		.loc 1 223 0
 885 09f0 14301BE5 		sub	sp, fp, #16
 886 09f4 0030D3E5 		ldmfd	sp, {r4, fp, sp, pc}
 887 09f8 0300A0E1 	.L56:
 888 09fc FEFFFFEB 		.align	2
 889 0a00 030000EA 	.L55:
 890              		.word	.LC1
 219:display.c     **** 		}
 220:display.c     **** 		else display_putchar(*p);					// kein Steuerzeichen gefunden
 891              	986919
 892 0a04 14301BE5 	.LFE9:
 894 0a0c 0300A0E1 		.section	.debug_frame,"",%progbits
 895 0a10 FEFFFFEB 	.Lframe0:
 896              		.4byte	.LECIE0-.LSCIE0
 897              	.LSCIE0:
 898 0a14 14301BE5 		.4byte	0xffffffff
 899 0a18 013083E2 		.byte	0x1
 900 0a1c 14300BE5 		.ascii	"\000"
 901              		.uleb128 0x1
 902 0a20 14301BE5 		.sleb128 -4
 903 0a24 0030D3E5 		.byte	0xe
 904 0a28 000053E3 		.byte	0xc
 905 0a2c 70FEFF1A 		.uleb128 0xd
 221:display.c     **** 	}
 222:display.c     **** 	va_end(ap);										// Ende variable Argumentenliste
 223:display.c     **** }
 906              	.align	2
 907 0a30 10D04BE2 	.LECIE0:
 908 0a34 10A89DE8 	.LSFDE0:
 909              		.4byte	.LEFDE0-.LASFDE0
 910              	.LASFDE0:
 911              		.4byte	.Lframe0
 912 0a38 14000000 		.4byte	.LFB2
 913 0a3c 67666666 		.4byte	.LFE2-.LFB2
 914              		.align	2
 915              	.LEFDE0:
 1125              		.byte	0x5d
DEFINED SYMBOLS
                            *ABS*:00000000 display.c
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:13     .text:00000000 delay1us
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:20     .text:00000000 $a
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:24     .text:00000008 Label
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:28     .text:00000018 Ende
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:37     .text:0000001c lcd_write
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:188    .text:000001d4 display_init
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:267    .text:000002a0 display_putchar
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:294    .text:000002cc display_putstr
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:332    .text:00000314 display_set_cursor
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:374    .text:00000368 display_clear
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:409    .text:000003ac $d
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:420    .text:000003b0 display_printf
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:425    .text:000003b0 $a
C:\Users\Aomx\AppData\Local\Temp/cc3N0wpy.s:912    .text:00000a38 $d

UNDEFINED SYMBOLS
memcpy
